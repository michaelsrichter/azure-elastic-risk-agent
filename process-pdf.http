### Test ProcessPdfFunction with custom Elasticsearch configuration (full override)
POST http://localhost:7071/api/process-pdf
Content-Type: application/json

{
  "fileContent": "JVBERi0xLjQKMSAwIG9iao8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCgoyIDAgb2JqCjw8Ci9UeXBlIC9QYWdlcwovS2lkcyBbMyAwIFJdCi9Db3VudCAxCj4+CmVuZG9iagoKMyAwIG9iao8PAovVHlwZSAvUGFnZQovUGFyZW50IDIgMCBSCi9NZWRpYUJveCBbMCAwIDYxMiA3OTJdCi9Db250ZW50cyA0IDAgUgo+PgplbmRvYmoKCjQgMCBvYmoKPDwKL0xlbmd0aCA0NAo+PgpzdHJlYW0KQlQKL0YxIDEyIFRmCjEwMCA3MDAgVGQKKFJpc2sgQXNzZXNzbWVudCBUZXN0IFBERikgVGoKRVQKZW5kc3RyZWFtCmVuZG9iagoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDEwIDAwMDAwIG4gCjAwMDAwMDAwNTMgMDAwMDAgbiAKMDAwMDAwMDEwMCAwMDAwMCBuIAowMDAwMDAwMTc4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUgo+PgpzdGFydHhyZWYKMjcyCiUlRU9G",
  "metadata": {
    "id": "custom-pdf-001",
    "filenameWithExtension": "custom-report.pdf",
    "fullPath": "Custom Risk Assessments/custom-report.pdf",
    "versionNumber": "1.0",
    "modified": "2025-08-22T18:25:42Z",
    "created": "2025-08-22T18:25:42Z",
    "link": "https://custom.sharepoint.com/sites/CustomSite/Custom%20Risk%20Assessments/custom-report.pdf"
  },
  "elasticsearchConfig": {
    "uri": "http://custom-elasticsearch:9200",
    "apiKey": "custom-api-key-67890",
    "indexName": "custom-risk-documents"
  }
}

### Test ProcessPdfFunction with custom Elasticsearch configuration (full override)
POST http://localhost:7071/api/process-pdf
Content-Type: application/json

{
  "fileContent": "JVBERi0xLjQKMSAwIG9iao8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCgoyIDAgb2JqCjw8Ci9UeXBlIC9QYWdlcwovS2lkcyBbMyAwIFJdCi9Db3VudCAxCj4+CmVuZG9iagoKMyAwIG9iao8PAovVHlwZSAvUGFnZQovUGFyZW50IDIgMCBSCi9NZWRpYUJveCBbMCAwIDYxMiA3OTJdCi9Db250ZW50cyA0IDAgUgo+PgplbmRvYmoKCjQgMCBvYmoKPDwKL0xlbmd0aCA0NAo+PgpzdHJlYW0KQlQKL0YxIDEyIFRmCjEwMCA3MDAgVGQKKFJpc2sgQXNzZXNzbWVudCBUZXN0IFBERikgVGoKRVQKZW5kc3RyZWFtCmVuZG9iagoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDEwIDAwMDAwIG4gCjAwMDAwMDAwNTMgMDAwMDAgbiAKMDAwMDAwMDEwMCAwMDAwMCBuIAowMDAwMDAwMTc4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUgo+PgpzdGFydHhyZWYKMjcyCiUlRU9G",
  "metadata": {
    "id": "custom-pdf-001",
    "filenameWithExtension": "custom-report.pdf",
    "fullPath": "Custom Risk Assessments/custom-report.pdf",
    "versionNumber": "1.0",
    "modified": "2025-08-22T18:25:42Z",
    "created": "2025-08-22T18:25:42Z",
    "link": "https://custom.sharepoint.com/sites/CustomSite/Custom%20Risk%20Assessments/custom-report.pdf"
  },
  "elasticsearchConfig": {
    "uri": "http://custom-elasticsearch:9200",
    "apiKey": "custom-api-key-67890",
    "indexName": "custom-risk-documents"
  }
}


### Test ProcessPdfFunction with partial custom Elasticsearch configuration (only custom index)
POST http://localhost:7071/api/process-pdf
Content-Type: application/json

{
  "fileContent": "JVBERi0xLjQKMSAwIG9iao8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCgoyIDAgb2JqCjw8Ci9UeXBlIC9QYWdlcwovS2lkcyBbMyAwIFJdCi9Db3VudCAxCj4+CmVuZG9iagoKMyAwIG9ijo8PAovVHlwZSAvUGFnZQovUGFyZW50IDIgMCBSCi9NZWRpYUJveCBbMCAwIDYxMiA3OTJdCi9Db250ZW50cyA0IDAgUko+PgplbmRvYmoKCjQgMCBvYmoKPDwKL0xlbmd0aCA0NAo+PgpzdHJlYW0KQlQKL0YxIDEyIFRmCjEwMCA3MDAgVGQKKFJpc2sgQXNzZXNzbWVudCBUZXN0IFBERikgVGoKRVQKZW5kc3RyZWFtCmVuZG9iagoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDEwIDAwMDAwIG4gCjAwMDAwMDAwNTMgMDAwMDAgbiAKMDAwMDAwMDEwMCAwMDAwMCBuIAowMDAwMDAwMTc4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUko+PgpzdGFydHhyZWYKMjcyCiUlRU9G",
  "metadata": {
    "id": "specialized-pdf-001",
    "filenameWithExtension": "specialized-report.pdf",
    "fullPath": "Specialized Risk Assessments/specialized-report.pdf",
    "versionNumber": "1.0",
    "modified": "2025-08-22T18:25:42Z",
    "created": "2025-08-22T18:25:42Z",
    "link": "https://specialized.sharepoint.com/sites/SpecializedSite/Specialized%20Risk%20Assessments/specialized-report.pdf"
  },
  "elasticsearchConfig": {
    "indexName": "specialized-documents"
  }
}

### Test ProcessPdfFunction with tenant-specific Elasticsearch configuration (multi-tenant scenario)
POST http://localhost:7071/api/process-pdf
Content-Type: application/json

{
  "fileContent": "JVBERi0xLjQKMSAwIG9iao8PAovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCgoyIDAgb2JqCjw8Ci9UeXBlIC9QYWdlcwovS2lkcyBbMyAwIFJdCi9Db3VudCAxCj4+CmVuZG9qagoKMyAwIG9ijo8PAkovVHlwZSAvUGFnZQovUGFyZW50IDIgMCBSCi9NZWRpYUJveCBbMCAwIDYxMiA3OTJdCi9Db250ZW50czIUIAoKNCAwIG9iago8PAovTGVuZ3RoIDQ0Cj4+CnN0cmVhbQpCVAovRjEgMTIgVGYKMTAwIDcwMCBUZAooUmlzayBBc3Nlc3NtZW50IFRlc3QgUERGKSBUagoKRVQKZW5kc3RyZWFtCmVuZG9iagoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDEwIDAwMDAwIG4gCjAwMDAwMDAwNTMgMDAwMDAgbiAKMDAwMDAwMDEwMCAwMDAwMCBuIAowMDAwMDAwMTc4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUjo+PgpzdGFydHhyZWYKMjcyCiUlRU9G",
  "metadata": {
    "id": "tenant-b-pdf-001",
    "filenameWithExtension": "tenant-b-report.pdf",
    "fullPath": "Tenant B Risk Assessments/tenant-b-report.pdf",
    "versionNumber": "1.0",
    "modified": "2025-08-22T18:25:42Z",
    "created": "2025-08-22T18:25:42Z",
    "link": "https://tenant-b.sharepoint.com/sites/TenantBSite/Tenant%20B%20Risk%20Assessments/tenant-b-report.pdf"
  },
  "elasticsearchConfig": {
    "uri": "http://tenant-b-elasticsearch:9200",
    "apiKey": "tenant-b-api-key-abc123",
    "indexName": "tenant-b-risk-documents"
  }
}

### Test ProcessPdfFunction with Sample PDF Request (using default configuration)
POST http://localhost:7071/api/process-pdf
Content-Type: application/json

{
  "fileContent": "JVBERi0xLjQKMSAwIG9iao8PAkovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCgoyIDAgb2JqCjw8Ci9UeXBlIC9QYWdlcwovS2lkcyBbMyAwIFJdCi9Db3VudCAxCj4+CmVuZG9iagoKMyAwIG9ino8PAkovVHlwZSAvUGFnZQovUGFyZW50IDIgMCBSCi9NZWRpYUJveCBbMCAwIDYxMiA3OTJdCi9Db250ZW50cyA0IDAgUjo+PgplbmRvYmoKCjQgMCBvYmoKPDwKL0xlbmd0aCA0NAo+PgpzdHJlYW0KQlQKL0YxIDEyIFRmCjEwMCA3MDAgVGQKKFJpc2sgQXNzZXNzbWVudCBUZXN0IFBERikgVGoKRVQKZW5kc3RyZWFtCmVuZG9iagoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDEwIDAwMDAwIG4gCjAwMDAwMDAwNTMgMDAwMDAgbiAKMDAwMDAwMDEwMCAwMDAwMCBuIAowMDAwMDAwMTc4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUio+PgpzdGFydHhyZWYKMjcyCiUlRU9G",
  "metadata": {
    "id": "pub-2025-cybersecurity-report-001",
    "filenameWithExtension": "pub-2025-cybersecurity-report.pdf",
    "fullPath": "Risk Assessments/pub-2025-cybersecurity-report.pdf",
    "versionNumber": "1.0",
    "modified": "2025-08-22T18:25:42Z",
    "created": "2025-08-22T18:25:42Z",
    "link": "https://m365x22659200.sharepoint.com/sites/GlobalSales/Risk%20Assessments/pub-2025-cybersecurity-report.pdf"
  }
}

### Alternative test with minimal payload
POST http://localhost:7071/api/process-pdf  
Content-Type: application/json

{
  "fileContent": "JVBERi0xLjQKMSAwIG9ijo8PAkovVHlwZSAvQ2F0YWxvZwovUGFnZXMgMiAwIFIKPj4KZW5kb2JqCgoyIDAgb2JqCjw8Ci9UeXBlIC9QYWdlcwovS2lkcyBbMyAwIFJdCi9Db3VudCAxCj4+CmVuZG9iagoKMyAwIG9ijo8PAkovVHlwZSAvUGFnZQovUGFyZW50IDIgMCBSCi9NZWRpYUJveCBbMCAwIDYxMiA3OTJdCi9Db250ZW50cyA0IDAgUio+PgplbmRvYmoKCjQgMCBvYmoKPDwKL0xlbmd0aCA0NAo+PgpzdHJlYW0KQlQKL0YxIDEyIFRmCjEwMCA3MDAgVGQKKFJpc2sgQXNzZXNzbWVudCBUZXN0IFBERikgVGoKRVQKZW5kc3RyZWFtCmVuZG9iagoKeHJlZgowIDUKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMDEwIDAwMDAwIG4gCjAwMDAwMDAwNTMgMDAwMDAgbiAKMDAwMDAwMDEwMCAwMDAwMCBuIAowMDAwMDAwMTc4IDAwMDAwIG4gCnRyYWlsZXIKPDwKL1NpemUgNQovUm9vdCAxIDAgUio+PgpzdGFydHhyZWYKMjcyCiUlRU9G",
  "metadata": {
    "id": "test-doc-001",
    "filenameWithExtension": "test.pdf",
    "versionNumber": "1.0"
  }
}

### Test error handling with invalid PDF
POST http://localhost:7071/api/process-pdf
Content-Type: application/json

{
  "fileContent": "aW52YWxpZCBwZGYgZGF0YQ==",
  "metadata": {
    "id": "invalid-doc-001",
    "filenameWithExtension": "invalid.pdf"
  }
}

### Test validation with empty payload
POST http://localhost:7071/api/process-pdf
Content-Type: application/json

{
}