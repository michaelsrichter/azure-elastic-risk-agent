# Test IndexDocument Function

### Sample request to index a document chunk
POST http://localhost:7071/api/index-document
Content-Type: application/json

{
  "documentMetadata": {
    "@odata.etag": "W/\"1\"",
    "ItemInternalId": "123",
    "ID": 1,
    "{Name}": "Sample Document",
    "{FilenameWithExtension}": "sample.pdf",
    "{FullPath}": "/documents/sample.pdf",
    "{VersionNumber}": "1.0",
    "Author": {
      "@odata.type": "#Microsoft.Azure.ConnectorServices.SharePoint.User",
      "Claims": "user@example.com",
      "DisplayName": "John Doe",
      "Email": "john.doe@example.com",
      "Picture": ""
    },
    "Editor": {
      "@odata.type": "#Microsoft.Azure.ConnectorServices.SharePoint.User",
      "Claims": "editor@example.com",
      "DisplayName": "Jane Editor",
      "Email": "jane.editor@example.com",
      "Picture": ""
    },
    "Modified": "2025-09-28T10:30:00Z",
    "Created": "2025-09-28T10:00:00Z",
    "{Link}": "https://example.sharepoint.com/documents/sample.pdf",
    "{DriveId}": "drive123",
    "{DriveItemId}": "item456",
    "{ContentType}": {
      "@odata.type": "#Microsoft.Azure.ConnectorServices.SharePoint.ContentType",
      "Id": "0x0101",
      "Name": "Document"
    }
  },
  "pageNumber": 1,
  "pageChunkNumber": 1,
  "chunk": "This is the first chunk of text extracted from page 1 of the PDF document. It contains important information about risk assessment procedures."
}

### Another sample with different page and chunk
POST http://localhost:7071/api/index-document
Content-Type: application/json

{
  "documentMetadata": {
    "{FilenameWithExtension}": "sample.pdf",
    "{FullPath}": "/documents/sample.pdf",
    "{VersionNumber}": "1.0",
    "Modified": "2025-09-28T10:30:00Z",
    "Created": "2025-09-28T10:00:00Z",
    "{Link}": "https://example.sharepoint.com/documents/sample.pdf"
  },
  "pageNumber": 1,
  "pageChunkNumber": 2,
  "chunk": "This is the second chunk of text from the same page. It continues with more risk assessment details and procedures."
}